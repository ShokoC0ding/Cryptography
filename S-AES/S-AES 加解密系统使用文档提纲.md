# S-AES 加解密系统使用文档提纲

## 1. S-AES 加解密系统开发手册

### 1.1 系统概述

- 本系统采用c/s架构来实现S-AES加解密算法——支持普通的加解密，ASCII码的加解密，多重加密以及工作模式等功能。

### 1.2 S-AES 加密算法简介

- 对16位数据和密钥进行加密，采用多轮变换操作S-AES 算法步骤：

**S-Box替换**：每个字节通过查找表进行替换，以引入非线性，增强加密安全性。

**行移位**：将矩阵的第二行左移1位，以增加数据的混淆，使相邻字节的关联减弱。

**列混淆**：在有限域上进行列的线性变换，将各列数据混合，进一步增强加密的扩散效果。

**轮密钥添加**：将当前状态与轮密钥逐位异或，确保密钥参与每轮加密，从而增强安全性。

整个过程通常经过多轮加密，在最后一轮省略“列混淆”操作，以完成最终加密。

### 1.3 拓展功能：ASII编码字符串

- 此功能拓展使得加密算法的数据输入可以直接支持ASCII编码字符串。这一改进让加密算法不仅能处理二进制数据，还可以方便地处理文本信息，为实际应用提供了更大的灵活性和适用范围。

### 1.4 多重加密

- **双重加密**：双重加密通过两次应用S-AES算法提升数据保密性。它使用32位密钥（K1+K2）：明文先用K1加密生成中间密文，再用K2进一步加密生成最终密文。解密过程则是相反的，首先用K2解密中间密文，再用K1解密还原明文。这种双重加密增强了安全性，因为需要两个密钥组合才能成功解密。
- **中间相遇攻击**：中间相遇攻击是一种针对双重加密的密码分析方法。通过在加密的正向（明文到密文）和反向（密文到明文）过程中分别计算中间值并比对，攻击者可以在正反两方向的中间找到相同结果。借助已知的明文-密文对，攻击者可通过找到相遇的中间值，从而推测密钥的部分信息。该方法要求足够的明文-密文对，并且适用于满足特定条件的加密算法。
- **三重加密**：三重加密提供了更高级的安全保护。它可以采用32位或48位密钥。32位密钥模式中，依次用K1加密、K2解密、再用K1加密；48位密钥模式中，依次用K1、K2、K3进行加密和解密。解密过程则反向进行。这种多轮加解密结构使得数据保护更为坚固，同时进一步增加了密钥的复杂度和攻击的难度。



### 1.5 CBC工作模式

- **CBC模式**：在CBC模式（密码分组链接模式）中，明文数据首先分成16位块，与初始向量（IV）进行异或，然后用S-AES加密得到第一个密文块。接下来，每个明文块在加密前与前一个密文块异或，再次进行S-AES加密，直至完成。最终所有密文块串联组成完整的密文。解密时，使用相同的初始向量和S-AES算法，每个密文块经解密后与前一密文块异或，还原出明文。CBC模式中，如果密文块被篡改，解密会导致后续明文错误，提高了对数据篡改的敏感性，因此适合需要数据完整性保护的场景。
- **适用场景**：CBC模式适合安全要求较高的场景，尤其在数据完整性和保密性要求强的数据传输中被广泛使用。其典型应用包括金融数据、敏感文件传输等场景。通过随机的初始向量（IV）和密文传播特性，CBC可以有效防范被动攻击和重复攻击。

## 2. 过关测试

### 2.1 第一关：基本测试

- **明文：** 1010101010101010 
       **密钥：** 1110010100001001

 

- 展示二进制的加解密操作：

输入明文与密钥进行加密：

<img src="..\信息安全导论实验二\S_AES照片\2.1(1).png" style="zoom: 67%;" />

得到了密文：1101101100011100

接着输入密文与密钥进行解密：

<img src="..\信息安全导论实验二\S_AES照片\2.1(2).png" style="zoom: 67%;" />

- 测试结果：解密所得的信息和我们最开始使用的明文是一致的，至此我们通过了第一关的测试

### 2.2 第二关：交叉测试

- 本次测试使用内容如下：

**明文：** 1010001110110000 
 **密钥：** 0000011010101011

- 我们组测试结果：

| <img src="..\信息安全导论实验二\S_AES照片\2.2(1).png" style="zoom: 67%;" /> |
| ------------------------------------------------------------ |
| <img src="..\信息安全导论实验二\S_AES照片\2.2(2).png" style="zoom: 67%;" /> |

密文：0011010100111110，且能成功解密

- 别的小组的结果：

<img src="..\信息安全导论实验二\S_AES照片\2.2.png" style="zoom: 67%;" />

- 测试结果：我组和另一个小组的交叉测试结果是一样的， 交叉测试通过！

### 2.3 第三关：拓展功能

- 加密演示：

明文2：ABC

密钥2：0000011010101011

加密结果为: ['1100111000010010', '0110111000010111', '0100111000010101']

 <img src="..\信息安全导论实验二\S_AES照片\2.3(1).png" style="zoom: 67%;" />

- 对应解密演示

<img src="..\信息安全导论实验二\S_AES照片\2.3(2).png" style="zoom: 67%;" />

- 测试结果：解密成功，得到对应的明文，过关！

### 2.4 第四关：多重加密

- 双重加密测试:

**明文：** 1010101010101010 
 **密钥：** 10100011101100000000011010101011

加密演示：

<img src="..\信息安全导论实验二\S_AES照片\2.4(1).png" style="zoom: 67%;" />

所得密文为：1101000000010011

解密演示：

<img src="..\信息安全导论实验二\S_AES照片\2.4(2).png" style="zoom: 67%;" />

成功解密，测试通过。

 

- 中间相遇攻击破解

按要求输入我们已知的明文和密文对，假如说我们现在知道两对：

**明文1：**1010001110110000 
 **密文1：**1001100101100101

 

**明文2：**0000011010101011
 **密文2：**1100011110100100

 

破解情况：

<img src="..\信息安全导论实验二\S_AES照片\2.4(3).png" style="zoom: 67%;" />

破解结果: 我们找到了两个密钥 密钥1：01101100101111000110000111101110 密钥2：01100001111011100110110010111100

但是如果随机给出明密文对，也不总是能破解。

- 三重加密测试

三重加密将S-AES算法通过三重加密进行扩展，我们按照按照32 bits密钥Key(K1+K2)的模式进行三重加密解密

**明文**：0000111100001111 

**2个密钥**：0100101011110101;1101011100101000

加密演示：

<img src="..\信息安全导论实验二\S_AES照片\2.4(6).png" style="zoom: 67%;" />

得到密文：1010000110001111

再进行解密演示：

<img src="..\信息安全导论实验二\S_AES照片\2.4(7).png" style="zoom: 67%;" />

成功解密，所得结果与明文一致，故通过测试。

### 2.5 第五关：CBC工作模式

我们基于S-AES算法，使用密码分组链(CBC)模式对较长的明文消息进行加密。 注意初始向量(16 bits) 的生成，并需要加解密双方共享。 在CBC模式下进行加密，并尝试对密文分组进行替换或修改， 然后进行解密

**明文**：1010101011011010, 1010010110011101, 1010110111011010, 1010100110011101 

**初始化向量**：1100110011001100

 **密钥**：0100101011110101

 

加密演示：

<img src="..\信息安全导论实验二\S_AES照片\2.5(1).png" style="zoom: 67%;" />

得到密文：0110100111001001,1110111001110101,0101100010011000,0100101010001001

解密演示：

<img src="..\信息安全导论实验二\S_AES照片\2.5(2).png" style="zoom: 67%;" />

成功得到原来的密文，加解密成功

接着调转密文块的分组顺序，下面演示篡改密文后的解密结果：

<img src="..\信息安全导论实验二\S_AES照片\2.5(3).png" style="zoom: 67%;" />

篡改后生成的明文与之前不一致，说明密文被篡改后无法得到正确的明文。

故测试通过。

## 3. 用户指南

### 3.1 使用指南

#### 3.1.1 用户界面总览

<img src="..\信息安全导论实验二\S_AES照片\3.1.1.png" style="zoom: 67%;" />

·    系统主页上方提供了多种操作选项供用户选择，包括二进制、ASCII模式、多重加密模式（双重和三重加密），以及 CBC 模式等。用户可以根据实际需求选择不同的操作类型，并通过界面清晰的指示完成加密和解密流程。

#### 3.1.2 加解密操作

- **输入要求：**
       用户需要根据所选模式输入数据。例如，选择 ASCII 模式时，输入应为 ASCII 编码的字符串；选择二进制模式时，则应为二进制数据。此外，用户还需提供相应的密钥以保证数据安全性。
- **加密模式选择：**
       用户可以选择所需的加密模式：包括二进制、ASCII、多重加密（双重和三重加密）、或 CBC 模式。每种模式对应的输入和输出形式略有不同，以满足不同应用场景下的需求。
- **执行操作：**
       确认输入信息和密钥后，用户点击“加密”或“解密”按钮，即可启动     S-AES 系统执行所选操作。在系统完成处理后，用户将获得密文或明文输出。

#### 3.1.3 错误处理

<img src="..\信息安全导论实验二\S_AES照片\3.1.3(1).png" style="zoom: 67%;" />

<img src="..\信息安全导论实验二\S_AES照片\3.1.3(2).png" style="zoom: 67%;" />

- 如果用户输入数据不符合所选模式的要求（如输入格式错误、密钥不合法等），系统将自动报错。提示信息会指出具体的错误类型并提供相应的纠正建议。用户根据提示修改输入即可完成操作。

 

#### 3.1.4 特殊功能

·    **多重加密功能**
 系统支持多重加密，包括双重和三重加密。用户可以输入32bits密钥或者多个密钥，来实现更高级别的数据保护。这种设计能够有效增强数据的抗破解能力。

<img src="..\信息安全导论实验二\S_AES照片\3.1.4(1).png" style="zoom: 67%;" />

<img src="..\信息安全导论实验二\S_AES照片\3.1.4(2).png" style="zoom: 67%;" />

·    **CBC模式操作**
 CBC（密码分组链接）模式通过在每一加密轮中对明文块进行异或处理，进一步提升了数据的随机性和安全性。系统会要求用户输入一个初始向量（IV），并将其与密钥一起用于加解密操作。CBC 模式能够有效防止密文模式的重复，从而增强安全性。

<img src="..\信息安全导论实验二\S_AES照片\3.1.4(3).png" style="zoom: 67%;" />

### 3.2 常见问题

- 常见问题与解答

问题：输入的 ASCII 字符串加密后显示乱码，这正常吗？

解答： 是的，这是正常现象。加密后的数据会经过复杂的变换，输出的字符可能包含不可打印或无法显示的字符（即所谓的"乱码"）。只要有正确的密钥，解密后能恢复成原始的明文内容。

 

问题：为什么系统提示“密钥格式错误”？

解答： S-AES 系统要求密钥长度和格式符合特定要求，例如必须为16位二进制密钥。检查输入密钥格式是否正确，确保符合系统提示中的要求即可。

 

问题：选择多重加密模式时，能否使用相同的密钥？

解答： 多重加密模式可以使用相同或不同的密钥，但为增强安全性，建议使用不同的密钥来进行双重或三重加密操作。

 

问题：解密时如何确认初始向量（IV）？

解答： CBC 模式中，解密时需使用与加密时相同的初始向量（IV）。通常，IV 由加密方生成并与密钥一起共享。请确保解密时输入的 IV 与加密时一致，否则无法正确恢复明文。

 

问题：系统不响应或报错怎么办？

解答： 如果系统长时间无响应，可能是因为输入数据格式不符或密钥不合法。请检查所有输入是否正确。如果问题持续，请尝试刷新页面或重启系统。

 

问题：密钥丢失后是否可以恢复原始数据？

解答： 不可以。S-AES 系统的安全性基于密钥的保密性，一旦密钥丢失，无法通过系统直接恢复原始数据。请妥善保存密钥。

 

问题：在 CBC 模式下篡改某一密文块后会出现什么情况？

解答： 如果某个密文块被篡改，解密过程中将导致该块及其后的块解密出错误的内容。这是 CBC 模式的特点，因此推荐在应用中加入数据完整性验证以防篡改。